[build]
  publish = "dist"
  command = "npm run build"

# Redirect API calls and dynamic SEO routes to Render backend
[[redirects]]
  from = "/api/*"
  to = "https://jeopardy-b937.onrender.com/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/generate-quiz"
  to = "https://jeopardy-b937.onrender.com/generate-quiz"
  status = 200
  force = true

[[redirects]]
  from = "/sitemap.xml"
  to = "https://jeopardy-b937.onrender.com/sitemap.xml"
  status = 200
  force = true

# Proxy quiz pages so crawlers can access server-rendered quiz pages
[[redirects]]
  from = "/quiz/:id"
  to = "https://jeopardy-b937.onrender.com/quiz/:id"
  status = 200
  force = true

[[redirects]]
  # Serve the SPA index for language routes so direct visits to /en/ or /it/ do not 404
  from = "/en/*"
  to = "/index.html"
  status = 200
  force = false

[[redirects]]
  from = "/en"
  to = "/index.html"
  status = 200
  force = false

[[redirects]]
  from = "/it/*"
  to = "/index.html"
  status = 200
  force = false

[[redirects]]
  from = "/it"
  to = "/index.html"
  status = 200
  force = false

# Optional: forward any other server endpoints under /server/* to Render
[[redirects]]
  from = "/server/*"
  to = "https://jeopardy-b937.onrender.com/:splat"
  status = 200
  force = true
